# Survey Question Analysis
# 서베이 문항 분석 및 통합 프로젝트

## 1. 프로젝트 개요

### 1.1 목적
- 역대 모든 서베이에서 사용된 문항을 분석하여 **동일/유사 문항 그룹화**
- Master DB에서 활용할 수 있는 **고유 Question Key** 생성
- 향후 서베이 분석 시 일관된 문항 매핑 체계 구축

### 1.2 데이터 소스
- **파일**: `Survey Meta Data_251215.xlsx`
- **생성일**: 2024-12-15
- **내용**: 2006년~2025년 실시된 전체 서베이 문항 취합

---

## 2. 데이터 구조

### 2.1 엑셀 파일 시트 구성

| 시트명 | 행 수 | 열 수 | 설명 |
|--------|-------|-------|------|
| 1. Survey목록 | 355 | 16 | 전체 서베이 프로젝트 목록 |
| 2. Question(17556문항) | 17,556 | 10 | 전체 문항 (프로젝트별 중복 포함) |
| 3. Question_Unique함수(8066문항) | 8,066 | 45 | 엑셀 UNIQUE 함수로 중복 제거 |
| **4. Question_Cleansing(7343문항)** | 7,343 | 12 | **분석 대상** - 정제된 고유 문항 |
| 석연 | 7,363 | 16 | 작업 시트 (키워드 분석 진행 중) |
| 2. Question_통합(1067문항) | 1,067 | 850 | 통합된 마스터 문항 |
| 참고. 설문 항목별 분류체계 | 23 | 15 | OD/LD/MA/DD 분류 체계 |

### 2.2 서베이 목록 현황 (1. Survey목록)

#### 연도별 서베이 수
| 연도 | 서베이 수 | 연도 | 서베이 수 |
|------|-----------|------|-----------|
| 2006 | 15 | 2016 | 7 |
| 2007 | 17 | 2017 | 10 |
| 2008 | 14 | 2018 | 7 |
| 2009 | 31 | 2019 | 10 |
| 2010 | 15 | 2020 | 24 |
| 2011 | 15 | 2021 | 33 |
| 2012 | 11 | 2022 | 26 |
| 2013 | 5 | 2023 | 42 |
| 2014 | 13 | 2024 | 18 |
| 2015 | 8 | 2025 | 22 |

**총 서베이 수**: 355개 (2006~2025, 약 19년간)

#### 진단 유형별 분포
| 진단 유형 | 서베이 수 | 설명 |
|-----------|-----------|------|
| OD | 171 | 조직진단 (Organization Diagnosis) |
| LD | 126 | 리더십진단 (Leadership Diagnosis) |
| DD | 16 | 사외이사평가 (Director Diagnosis) |
| MA | 15 | 다면평가 (Multi-source Assessment) |
| 기타 | 27 | ES, 특수 프로젝트 등 |

### 2.3 고객사 목록

#### 프로젝트명 코드 구조
```
IG200601_우주일렉트로닉스_성과중심 조직 및 인사제도 구축
│       │                  │
│       │                  └─ 프로젝트명
│       └─ 회사명
└─ 프로젝트 코드 (IG + 연도 + 순번)
```

#### 주요 고객사 (그룹별)

| 그룹 | 고객사 | 프로젝트 수 |
|------|--------|-------------|
| **CJ** | CJ, CJ그룹, CJ Culture Survey, CJ VOICE ON | 32 |
| **SK** | SK그룹, SK하이닉스, SK네트웍스, SK케미칼, SK C&C | 23+ |
| **현대** | 현대자동차, 현대중공업, 현대상선, 현대위아, 현대글로벌서비스 | 10+ |
| **DGB** | DGB금융지주, DGB대구은행 | 8 |
| **LG** | LG CNS, LG디스플레이, LG패션 | 8 |
| **BNK** | BNK금융지주, BNK부산은행, BNK경남은행 | 3 |

#### 전체 고객사 목록 (120개사, 정규화 후)

<details>
<summary>전체 고객사 목록 보기 (클릭)</summary>

| No | 고객사명 | No | 고객사명 | No | 고객사명 |
|----|----------|----|---------|----|----------|
| 1 | ADT캡스 | 41 | 대한항공C&D | 81 | 유코카 |
| 2 | BMW파이낸셜서비스코리아 | 42 | 더블유컨셉코리아 | 82 | 이누스 |
| 3 | BNK | 43 | 더페이스샵코리아 | 83 | 이동의즐거움 |
| 4 | CJ | 44 | 도레이첨단소재 | 84 | 이스타항공 |
| 5 | DGB | 45 | 도시바삼성 | 85 | 이지메디컴 |
| 6 | DGB금융 | 46 | 동서식품 | 86 | 인팩 |
| 7 | DGB대구은행 | 47 | 동진테크윈 | 87 | 일지테크 |
| 8 | GSE&R | 48 | 두산엔진 | 88 | 전북은행 |
| 9 | KB국민은행 | 49 | 딜라이브 | 89 | 제뉴원사이언스 |
| 10 | KMW | 50 | 로카모빌리티 | 90 | 중부모터스 |
| 11 | LG CNS | 51 | 롯데자이언츠 | 91 | 중소기업진흥공단 |
| 12 | LG디스플레이 | 52 | 롯데제과 | 92 | 지속가능협의회 |
| 13 | LG패션 | 53 | 마이셰프 | 93 | 최종현학술원 |
| 14 | NH헤지자산운용 | 54 | 매일유업 | 94 | 컴투스 |
| 15 | PM인터내셔널 | 55 | 바로저축은행 | 95 | 케이워터기술 |
| 16 | SD바이오센서 | 56 | 바이오노트 | 96 | 코웨이 |
| 17 | SJ그룹 | 57 | 베어크리골프클럽 | 97 | 파라다이스 |
| 18 | SK | 58 | 보령제약 | 98 | 파크시스템즈 |
| 19 | SK가스 | 59 | 부산정관에너지 | 99 | 포스틸 |
| 20 | SK네트웍스 | 60 | 사회복지공동모금 | 100 | 하나머터리얼즈 |
| 21 | SK케미칼 | 61 | 성동조선해양 | 101 | 한국선급 |
| 22 | SK하이닉스 | 62 | 성보화학 | 102 | 한국수출보험공사 |
| 23 | iM뱅크 | 63 | 세중해운 | 103 | 한국오츠카제약 |
| 24 | 정상어학원 | 64 | 세코닉스 | 104 | 한샘 |
| 25 | 경방 | 65 | 세틀뱅크 | 105 | 한세실업 |
| 26 | 고영테크놀러지 | 66 | 스타벅스 | 106 | 한전KDN |
| 27 | 광주은행 | 67 | 시몬느ACC | 107 | 한전전력연구원 |
| 28 | 교촌F&B | 68 | 신원 | 108 | 헥토 |
| 29 | 그라비티 | 69 | 신흥 | 109 | 현대건설기계 |
| 30 | 글로비스 | 70 | 씨모텍 | 110 | 현대글로벌서비스 |
| 31 | 금용기계 | 71 | 씨앤에이치캐피탈 | 111 | 현대다이모스 |
| 32 | 금호P&B | 72 | 아이리버 | 112 | 현대상선 |
| 33 | 기획재정부 | 73 | 에이치라인해운 | 113 | 현대시멘트 |
| 34 | 대동 | 74 | 엠앤소프트 | 114 | 현대위아 |
| 35 | 대우캐피탈 | 75 | 오쎄 | 115 | 현대자동차 |
| 36 | 대한도시가스 | 76 | 우리금융정보시스템 | 116 | 현대종합상사 |
| 37 | 대한석유협회 | 77 | 우주일렉트로닉스 | 117 | 현대중공업 |
| 38 | 대한제분 | 78 | 웅진식품 | 118 | 현대택배 |
| 39 | 대한항공C&D | 79 | 웅진에너지 | 119 | 현대파워텍 |
| 40 | 더블유컨셉코리아 | 80 | 원익 | 120 | 휴롬 |

</details>

#### 회사 코드 매핑 (상위)

| 코드 | 회사명 | 프로젝트 수 |
|------|--------|-------------|
| CJG | CJ그룹 | 32 |
| SKG | SK그룹 | 23 |
| SCK | SK케미칼 | 15 |
| HCT | 헥토 | 10 |
| LGF | LG패션 | 8 |
| DGB | DGB금융 | 8 |
| SKH | SK하이닉스 | 7 |
| SKN | SK네트웍스 | 6 |
| PDS | 파라다이스 | 6 |
| EUG | 유진투자증권 | 6 |

---

## 3. 분석 대상: Question_Cleansing (7,343문항)

### 3.1 컬럼 구조

| 컬럼명 | 설명 | 비고 |
|--------|------|------|
| No | 일련번호 | 대부분 비어있음 |
| **대분류** | 진단 유형 | OD, LD, MA, DD |
| 중분류 | 세부 분류 | 대부분 비어있음 |
| 소분류1 | 세부 분류 | 대부분 비어있음 |
| 소분류2 | 세부 분류 | 대부분 비어있음 |
| **문항** | 문항 텍스트 | 핵심 분석 대상 |
| **No1~No6** | 원본 문항 번호 | 동일 문항 재사용 추적 |

### 3.2 대분류별 문항 수

| 대분류 | 문항 수 | 비율 | 설명 |
|--------|---------|------|------|
| **OD** | 5,179 | 70.5% | 조직진단 |
| **LD** | 1,590 | 21.7% | 리더십진단 |
| **MA** | 364 | 5.0% | 다면평가 |
| **DD** | 210 | 2.9% | 사외이사평가 |
| **합계** | 7,343 | 100% | |

### 3.3 대분류별 문항 예시

#### OD (조직진단) - 5,179개
```
1. 우리 회사의 비전과 전략이 무엇인지 이해하고 있다
2. 우리 회사는 매년 명확한 경영방침과 전략을 세운다
3. 우리 부서는 성장을 위해 필요한 핵심역량을 보유하고 있다
4. 전략 실행을 위한 인적/물적 자원이 적절히 배치되어 있다
5. 나는 나의 직무가 회사의 장기적 전략 달성에 어떻게 기여하는지 잘 알고 있다
```

#### LD (리더십진단) - 1,590개
```
1. 리더는 직원들이 개인/가족 사생활에 특별한 상황이 발생할 시 융통성을 발휘한다
2. 리더는 집단 구성원들에게 표준 규칙과 규정을 따르도록 요청한다
3. 리더는 모든 구성원들을 평등하게 대우한다
4. 리더는 빈둥거리는 구성원들에게 전력을 다해 일하도록 한다
5. 리더는 과업이 원활히 수행되도록 적절한 계획을 수립한다
```

#### MA (다면평가) - 364개
```
1. 나의 동료는 특별한 문제가 없더라도 끊임없이 개선점을 찾으려 노력하며 변화를 주도한다.
2. 나의 동료는 회사의 경쟁력에 영향을 미치는 경영변화, 기술, 경쟁사, 시장동향을 지속적으로 파악한다.
3. 나의 동료는 도전적 목표(Stretch Goal)를 설정하고 이를 추진한다.
4. 나의 동료는 열린 마음으로 내부 고객 (동료, 리더, 부하 직원 등)의 의견을 경청한다.
5. 나의 동료는 부하 직원의 업무 성과에 대해 공정하고 명확한 피드백을 제공한다.
```

#### DD (사외이사평가) - 210개
```
1. 전략에 대한 토론 시 개인의 전문지식, 능력, 경험을 적극적으로 기여함
2. 전략 계획 수림과 그 절차에 대한 이해가 높음
3. 은행/금융산업에 대한 이해가 있고 그 내에서의 우리 회사 특수성을 인지함
4. 기본적인 회계 개념이나 재무제표에 대한 이해가 있고 회계관련 규정의 역할을 인지함
5. 예산 및 재정 계획과 감독에 대해 적절한 경험과 지식을 갖추고 있음
```

### 3.4 문항 재사용 현황 (No1~No6)

동일 문항이 여러 서베이에서 사용된 경우를 추적:

| 컬럼 | 값 존재 | 의미 |
|------|---------|------|
| No1 | 7,343개 | 모든 문항 (최초 사용) |
| No2 | 526개 | 2개 서베이에서 사용 |
| No3 | 121개 | 3개 서베이에서 사용 |
| No4 | 49개 | 4개 서베이에서 사용 |
| No5 | 14개 | 5개 서베이에서 사용 |
| No6 | 11개 | 6개 서베이에서 사용 |

#### 다중 사용 문항 예시 (6개 서베이에서 사용)
```
- 나의 리더은 항상 자신이 옳고 정답을 가지고 있다고 생각한다
- 나의 리더은 다른 사람을 기분 나쁘게 하거나 위협한다
- 나의 리더은 상황이나 업무에 대해 만족하지 못하고 회의적이며 부정적인 태도를 보인다
- 나의 리더은 자신의 문제를 타인의 탓으로 돌린다
- 나의 리더은 스트레스 상황에서 공격적인 성향을 보인다
```

---

## 4. 문항 텍스트 분석

### 4.1 문항 길이 통계

| 지표 | 값 |
|------|-----|
| 평균 | 47.7자 |
| 표준편차 | 36.7자 |
| 최소 | 11자 |
| 25% | 33자 |
| 중앙값 | 40자 |
| 75% | 50자 |
| 최대 | 666자 |

### 4.2 문항 시작 패턴 (상위 20개)

| 시작 패턴 | 문항 수 |
|-----------|---------|
| 나는 우리 회사의... | 262 |
| 우리 부서 구성원들... | 68 |
| 현 소속 사업부(그... | 51 |
| 우리 회사 구성원들... | 49 |
| 귀하로 하여금 업무... | 44 |
| 우리 조직 구성원들... | 41 |
| 우리 부서 사람들은... | 41 |
| 나의 부하 직원은... | 39 |
| 나의 부서 구성원들... | 34 |
| 우리 회사 사람들은... | 33 |

### 4.3 주요 키워드 빈도

| 키워드 | 빈도 | 키워드 | 빈도 |
|--------|------|--------|------|
| 우리 | 3,303 | 회사는 | 484 |
| 있다. | 1,365 | 구성원들은 | 461 |
| 나는 | 1,284 | 회사 | 451 |
| 나의 | 1,069 | 업무를 | 383 |
| 회사의 | 1,027 | 있는 | 372 |
| 있다 | 762 | 업무에 | 370 |
| 업무 | 695 | 필요한 | 305 |
| 대해 | 602 | 조직 | 290 |
| 리더는 | 583 | 조직의 | 282 |
| 위해 | 558 | 있다고 | 262 |

### 4.4 유사성 분석 기초

| 분석 항목 | 결과 |
|-----------|------|
| 완전 중복 문항 | 0개 (이미 정제됨) |
| 앞 30자 동일 문항 | 710개 |
| 유사 문항 후보 | 분석 필요 |

---

## 5. 분류 체계

### 5.1 조직진단(OD) 분류 체계

| 중분류 | 소분류1 | 소분류2 |
|--------|---------|---------|
| 경영전략 | 비전/전략 | 인지, 이해, 공감, 실천, 공유 |
| 조직문화 | 조직에너지 | Comfortable, Inertia, Corrosive, Productive Energy |
| | 핵심가치 | 인지, 공감, 실천 |
| 조직/프로세스 | 조직구조 | 조직 적절성, 수평적 R&R, 수직적 R&R |
| | 인력운영 | 업무량, 업무배분, 인력규모 |
| | 업무 프로세스 | 프로세스 효율성, 프로세스 명확성 |
| | 의사소통 | 수직적/수평적/조직내 의사소통 |
| | 의사결정 | 의사결정 속도, 단계, 권한위임 |
| | 업무인프라 | 자원제공, WLB |
| 리더십 | 리더행동 | 소통, 배려, 인정, 공정성 |
| | 역량발휘 | 방향제시, 동기부여, 육성 |
| 인사제도 | 직급/승진제도 | 역할, 직급 적합성, 승진 기준/공정성 |
| | 평가제도 | 제도 이해도, 피드백 제공, 제도 만족도 |
| | 보상제도 | 제도 이해, 보상 공정성, 복리후생 |
| | 채용 | 인재유지, 적시채용 |
| | 교육 | 제도 만족도, 성장 기회 제공 |
| 조직몰입도 | 조직몰입도 | Pride, 만족도, 추천 의사, 재직 의사, 성장감 |
| 기타 | 윤리, 다양성, 고객지향성, 고성과자 인식 | |

### 5.2 리더십진단(LD) 분류 체계

| 중분류 | 소분류1 | 소분류2 |
|--------|---------|---------|
| 비전/전략 | 비전/전략 | 인지, 이해, 공감, 실천, 공유 |
| 리더십 역량 | 동기부여 | 도전적인 목표 수립, 실패에 대한 격려 |
| | 인재육성 | 다양한 기회부여, 코칭 및 피드백 |
| | 변화관리 | 산업 트렌드 이해, 전략적 자원배분, 변화 필요성 인식 |
| | 권한위임 | 구성원에 대한 신뢰와 인정, 업무권한 부여 |
| | 업무지시 | 명확한 업무지시, 주기적인 피드백 |
| | 의사결정 | 정확한 근거에 기반한 판단, 시의적절한 의사결정 |
| | 목표관리 | 조직 목표와 연계된 개인 목표 설정, 주기적인 업무 점검 |
| Derailment | 자기과신 성향 | |
| | 공격 성향 | |
| | 냉소적 성향 | |
| | 자기방어 성향 | |
| | 스트레스 취약 성향 | |
| | 편향적 선호 성향 | |
| | 과도한 관리 성향 | |
| | 비일관적 성향 | |
| 기타 | 강점/보완점 | 강점역량, 보완필요역량 |

### 5.3 다면평가(MA) 분류 체계

| 중분류 | 소분류1 | 소분류2 |
|--------|---------|---------|
| 성과지향 | 성과추구 | 목표달성, 업무추진, 성과개선 |
| 역량 | 업무역량 | 전문성, 문제해결, 의사결정 |
| | 관계역량 | 소통, 협업, 배려 |
| 리더십 | 리더역량 | 동기부여, 육성, 권한위임 |
| 고객지향 | 고객서비스 | 고객이해, 고객만족 |
| 변화혁신 | 혁신추진 | 변화주도, 개선활동 |
| 협업/소통 | 협업 | 정보공유, 갈등해결 |
| 전문성 | 전문성 | 지식공유, 인재육성 |

### 5.4 사외이사평가(DD) 분류 체계

| 중분류 | 소분류1 | 소분류2 |
|--------|---------|---------|
| 전략적 역량 | 전략사고 | 경영전략 이해, 의사결정 |
| 전문성 | 전문지식 | 재무역량, 이슈파악, 자격요건 |
| 이사회 참여 | 참여도 | 참여 적극성, 공정성, 규정 준수 |
| | 참여 | 위원회 활동, 회의 참석 |
| 감독/견제 | 경영감독 | 윤리의식, 사회적 책임, 투명성 |

---

## 6. 금칙어 목록 (Stopwords for Keyword Analysis)

문항 키워드 분석 시 제외해야 할 단어 목록입니다.
고객사명이 문항에 포함된 경우 의미 없는 키워드로 추출될 수 있어 제외합니다.

### 6.1 고객사명 기반 금칙어

#### 대기업 그룹사
```
CJ, SK, LG, 현대, 삼성, 롯데, 한화, 두산
DGB, BNK, KB, NH, 우리, 신한, 하나
```

#### 주요 고객사 (전체 120개사)
```
ADT캡스, BMW파이낸셜서비스코리아, BNK, CJ, DGB, GSE&R, KB국민은행, KMW,
LG CNS, LG디스플레이, LG패션, NH헤지자산운용, PM인터내셔널, SD바이오센서,
SJ그룹, SK, SK가스, SK네트웍스, SK케미칼, SK하이닉스, iM뱅크, 정상어학원,
경방, 고영테크놀러지, 광주은행, 교촌F&B, 그라비티, 글로비스, 금용기계, 금호P&B,
기획재정부, 대동, 대우캐피탈, 대한도시가스, 대한석유협회, 대한제분, 대한항공C&D,
더블유컨셉코리아, 더페이스샵코리아, 도레이첨단소재, 도시바삼성, 동서식품, 동진테크윈,
두산엔진, 딜라이브, 로카모빌리티, 롯데자이언츠, 롯데제과, 마이셰프, 매일유업,
바로저축은행, 바이오노트, 베어크리골프클럽, 보령제약, 부산정관에너지, 사회복지공동모금,
성동조선해양, 성보화학, 세중해운, 세코닉스, 세틀뱅크, 스타벅스, 시몬느ACC,
신원, 신흥, 씨모텍, 씨앤에이치캐피탈, 아이리버, 에이치라인해운, 엠앤소프트, 오쎄,
우리금융정보시스템, 우주일렉트로닉스, 웅진식품, 웅진에너지, 원익, 유영제약, 유진투자증권,
유코카, 이누스, 이동의즐거움, 이스타항공, 이지메디컴, 인팩, 일지테크, 전북은행,
제뉴원사이언스, 중부모터스, 중소기업진흥공단, 지속가능협의회, 최종현학술원, 컴투스,
케이워터기술, 코웨이, 파라다이스, 파크시스템즈, 포스틸, 하나머터리얼즈, 한국선급,
한국수출보험공사, 한국오츠카제약, 한샘, 한세실업, 한전KDN, 한전전력연구원, 헥토,
현대건설기계, 현대글로벌서비스, 현대다이모스, 현대상선, 현대시멘트, 현대위아, 현대자동차,
현대종합상사, 현대중공업, 현대택배, 현대파워텍, 휴롬
```

### 6.2 조직 관련 금칙어
```
그룹, 홀딩스, 지주, 계열사, 본부, 센터
주식회사, (주), ㈜, Co., Ltd., Inc.
부서, 팀, 실, 사업부, 연구소, 연구원, 지점, 지사, 공장, 사무소
```

### 6.3 설문 문항 일반 불용어
```
것, 수, 등, 및, 또한, 때, 더, 좀, 꽤, 되, 하, 있, 없
이, 그, 저, 위, 아래, 만, 를, 을, 는, 은, 가, 에, 의
과, 와, 로, 으로, 에서, 부터, 까지, 대한, 대해, 통해
위해, 따라, 함께, 같이, 관련, 관한, 경우, 매우, 정말, 너무
많이, 조금, 약간, 모든, 각, 여러, 다양한, 특히, 주로, 보통
우리, 나는, 나의, 있다, 있다., 회사, 회사의, 회사는
리더는, 리더은, 구성원, 구성원들, 직원, 부서, 조직
```

---

## 7. 분석 방법론

### 7.1 형태소 분석기 선택

**Okt vs Komoran 비교 테스트**

| 분석기 | 테스트 문장 | 결과 |
|--------|-------------|------|
| **Okt** | "우리 회사의 비전과 전략이..." | `['비', '전과', '전략']` ❌ |
| **Komoran** | "우리 회사의 비전과 전략이..." | `['회사', '비전', '전략', '이해']` ✓ |

**결론**: Komoran 채택 (한글 복합명사 처리 우수)

### 7.2 문항 유사도 분석 접근법

1. **텍스트 전처리**
   - 특수문자 제거
   - 공백 정규화
   - 무의미 토큰 제거

2. **형태소 분석** (KoNLPy - **Komoran**)
   - 명사 추출
   - 불용어 제거
   - 2글자 이상 필터링
   - **키워드 7개 추출** (최적값)

3. **TF-IDF 벡터화**
   - 문항별 벡터 생성
   - 단어 중요도 계산
   - max_features: 3,000

4. **K-means 클러스터링**
   - 의미적 동일 문항 그룹화
   - **클러스터 수: 500개** (OD 문항 5,177개 기준)
   - 평균 클러스터 크기: 10.4개

5. **Master Question Key 부여** (예정)
   - 그룹별 대표 문항 선정
   - 고유 키 생성 (예: OD_001, LD_001)

### 7.3 클러스터링 결과 (OD 문항)

#### 클러스터 수 비교 테스트

| 클러스터 수 | 평균 크기 | 최대 크기 | 평가 |
|-------------|-----------|-----------|------|
| 20개 | 259개 | 1,745개 | ❌ 너무 넓음 |
| 250개 | 20.7개 | 159개 | △ 일부 혼합 |
| 300개 | 17.3개 | 118개 | △ 일부 혼합 |
| **500개** | **10.4개** | **63개** | ✓ 적정 |

#### 500개 클러스터 결과 요약

| 지표 | 값 |
|------|-----|
| 전체 OD 문항 | 5,177개 |
| 클러스터 수 | 500개 |
| 평균 클러스터 크기 | 10.4개 |
| 중앙값 | 8.5개 |
| 최소 | 1개 |
| 최대 | 63개 |

#### 크기별 클러스터 분포

| 클러스터 크기 | 클러스터 수 | 비율 |
|---------------|-------------|------|
| 1~3개 문항 | 44개 | 8.8% |
| 4~6개 문항 | 131개 | 26.2% |
| 7~10개 문항 | 144개 | 28.8% |
| 11~20개 문항 | 140개 | 28.0% |
| 21~50개 문항 | 37개 | 7.4% |
| 50개 초과 | 4개 | 0.8% |

#### 의미적 동일 문항 예시 (성공 사례)

**클러스터 491** (2개 문항) - 완벽 매칭
```
1. 동종업계나 타 업체에서 좋은 조건을 제시하더라도, 우리 회사에 근무할 것이다.
2. 동종업계나 타 업체에서 좋은 조건을 제시하더라도, 우리 회사에서 근무할 것이다.
```

**클러스터 330** (3개 문항) - 완벽 매칭
```
1. 우리 회사는 부서 간 성과 귀속이 명확하게 이루어지고 있다.
2. 우리 회사는 팀 간 성과 귀속이 명확하게 이루어지고 있다.
3. 우리 회사는 부서 간 성과 귀속이 명확하게 이루어지고 있다
```

**클러스터 289** (5개 문항) - 동일 주제
```
1. 나는 불필요한 보고/결재라인 때문에
2. 나는 불필요한 보고/결재라인 때문에 ①업무추진시 매번 어려움을 겪고 있다...
3. 나는 불필요한 보고/결재라인으로 인한 업무추진 어려움을 겪지 않는다.
4. 나는 불필요한 보고/결재라인 때문에 업무 추진에 어려움을 겪는 경우가 거의 없다.
5. 나는 불필요한 보고/결재라인 때문에 1. 업무추진시 매번 어려움을 겪고 있다...
```

#### 개선 필요 사례

**클러스터 12** (15개 문항) - "방식" 키워드로 혼합
```
- 사내 동호회 제도 운영에 대해 만족하고 있다
- 나의 부서 일하는 방식은 전년 대비 향상되었다
- 평가 상위 등급을 30%로 제한하는 방식으로...
(서로 다른 주제가 "방식" 키워드로 묶임)
```

### 7.4 결과 파일

| 파일명 | 설명 |
|--------|------|
| `results/OD_문항_클러스터링_500.xlsx` | OD 문항 500개 클러스터 결과 |
| `od_clusters_500.pkl` | Python pickle 파일 (중간 결과) |

### 7.5 기대 결과물

| 산출물 | 설명 | 상태 |
|--------|------|------|
| OD_문항_클러스터링_500.xlsx | OD 문항 클러스터링 결과 | ✓ 완료 |
| Question_Master.xlsx | 마스터 문항 목록 (고유 키 포함) | 예정 |
| Question_Mapping.xlsx | 원본 문항 → 마스터 문항 매핑 | 예정 |

---

## 8. 진행 상황

### 8.1 완료 항목
- [x] 엑셀 파일 구조 분석
- [x] 시트별 데이터 현황 파악
- [x] 대분류별 문항 수 집계
- [x] 문항 텍스트 기초 분석
- [x] 분류 체계 정리
- [x] 고객사 목록 추출 및 정규화 (120개사)
- [x] 금칙어 목록 생성
- [x] **형태소 분석기 선택** (Okt → Komoran)
- [x] **형태소 분석 및 키워드 추출** (7개 키워드)
- [x] **TF-IDF 벡터화**
- [x] **K-means 클러스터링** (500개 클러스터)
- [x] **OD 문항 클러스터링 결과 엑셀 저장**

### 8.2 진행 예정
- [ ] 클러스터 검증 및 수동 조정
- [ ] LD/MA/DD 문항 클러스터링
- [ ] 대분류/중분류/소분류 계층 분류
- [ ] Master Question Key 생성
- [ ] 결과 검증 및 정제

### 8.3 이슈 및 개선사항 (TF-IDF + K-means 방식)

#### 8.3.1 근본적 한계

**TF-IDF + K-means 클러스터링의 문제점:**

| 문제 | 설명 | 예시 |
|------|------|------|
| **키워드 기반 한계** | 단어 빈도만 고려, 문장 의미 무시 | "비전을 이해한다" vs "비전이 현실적이다" 구분 불가 |
| **문장 구조 무시** | 주어-목적어-서술어 관계 파악 불가 | "리더가 구성원을 신뢰" vs "구성원이 리더를 신뢰" 혼동 |
| **측정 개념 무시** | 설문이 측정하려는 Construct 고려 안함 | "비전 인지" vs "비전 공감" vs "비전 적절성" 혼합 |
| **일반 키워드 문제** | "방식", "존재" 등 범용 단어로 이질적 문항 묶임 | 아래 사례 참조 |

#### 8.3.2 큰 클러스터 분석 (이질적 문항 혼합 사례)

**클러스터 363 (63개 문항)** - "부서/업무/회사" 키워드
```
실제 포함된 다양한 주제:
- 부서 결속력: "우리 부서는 끈끈한 결속력이 있다"
- 연봉/보상: "나의 연봉은 내 업무능력, 노력과 성과기여도를 고려할 때 적절한 수준이다"
- 윤리규범: "나는 올바르게 일하는 기준과 원칙을 말해주는 윤리 규범에 대해 잘 알고 있다"
- 사무환경: "우리 회사의 사무기기는 낙후되어 사용함에 불편한 점이 있다"
- 동호회: "나는 회사에서 진행하는 각종 이벤트, 동호회 등의 프로그램으로 회사 생활에 재미를 느낀다"
- 1on1 미팅: "위 리더와의 1on1 시행 간격은?"
→ 완전히 다른 6개 이상의 측정 개념이 혼합됨
```

**클러스터 104 (59개 문항)** - "리더" 키워드
```
실제 포함된 다양한 주제:
- 피드백 채널: "나는 리더에 대해 솔직한 피드백을 제공할 수 있는 수단이나 채널을 갖고 있다"
- 리더 협조: "리더급 이상의 리더들 사이에 협조가 잘 이루어진다"
- Derailment(탈선성향): "나의 리더는 항상 자신이 옳고 정답을 가지고 있다고 생각한다"
- 권한위임: "나의 리더는 되도록 많은 업무를 구성원들에게 위임한다"
- 평가 공정성: "나의 리더는 성과 평가 시 객관적 기준으로 평가한다"
→ 리더십 관련이지만 세부 측정 개념이 5개 이상으로 다양
```

**클러스터 248 (250개 클러스터 시도 시)** - "존재" 키워드 오분류
```
묶인 문항들:
1. "우리 회사는 현실적으로 달성 가능한 비전이 존재한다" → 비전 적절성
2. "목표 달성과 상관없는 부서가 존재한다" → 조직 효율성
3. "외국어 교육을 수강하지 않은 이유는? 제도의 존재에 대해 모르고 있다" → 교육제도 인지
→ "존재"라는 단어 하나로 완전히 다른 3개 주제가 묶임
```

#### 8.3.3 개선 방향

**접근법 전환: 키워드 → 문장 의미(Semantic) 기반**

| 기존 방식 | 개선 방식 |
|-----------|-----------|
| TF-IDF (단어 빈도) | Sentence Embedding (문장 의미 벡터) |
| K-means (고정 클러스터) | Agglomerative (계층적 클러스터링) |
| 키워드 유사도 | Cosine Similarity (의미 유사도) |

**도구**:
- KoSBERT (Korean Sentence-BERT): `jhgan/ko-sroberta-multitask`
- 한국어 문장 전체를 768차원 벡터로 변환
- 의미적으로 유사한 문장은 벡터 공간에서 가까이 위치

---

## 9. Sentence Embedding 기반 분석 (개선안)

### 9.1 접근 방법

```
Stage 1: KoSBERT로 문장 임베딩
  └─ 각 문항을 768차원 의미 벡터로 변환

Stage 2: Cosine Similarity 계산
  └─ 모든 문항 쌍의 의미 유사도 측정

Stage 3: Agglomerative Clustering
  └─ 유사도 임계값 기반 계층적 클러스터링
  └─ 임계값 조절로 클러스터 크기 조정 가능

Stage 4: 검증 및 정제
  └─ 클러스터별 문항 검토
  └─ 필요시 LLM 기반 재분류
```

### 9.2 실행 결과 (2024-12-22)

#### 9.2.1 KoSBERT 임베딩 생성
- **모델**: `jhgan/ko-sroberta-multitask`
- **데이터**: OD 문항 5,179개
- **임베딩 차원**: 768
- **저장 파일**: `od_embeddings_kosbert.npy`

#### 9.2.2 Agglomerative Clustering
- **Distance Metric**: Cosine Distance
- **Linkage**: Average
- **Distance Threshold**: 0.20

#### 9.2.3 TF-IDF vs KoSBERT 결과 비교

| 항목 | TF-IDF (500 클러스터) | KoSBERT (threshold=0.20) |
|------|----------------------|--------------------------|
| 총 클러스터 수 | 500 | 1,967 |
| 평균 클러스터 크기 | 10.35 | 2.63 |
| 중앙값 클러스터 크기 | 8.5 | 1.0 |
| 최대 클러스터 크기 | 63 | 70 |
| 싱글톤 클러스터 | 3 | 994 |
| 2개 이상 클러스터 | 497 | 973 |
| 10개 이상 클러스터 | 211 | 73 |
| 20개 이상 클러스터 | 49 | 19 |

#### 9.2.4 품질 비교 예시

**KoSBERT 클러스터 (의미적으로 동일한 문항끼리 그룹화)**:
```
클러스터 449 (7개) - "비전 이해"
  1. 우리 회사의 비전과 전략이 무엇인지 이해하고 있다
  2. 우리회사의 비전이 무엇인지 이해하고 있다.
  3. 우리 회사의 경영전략이 무엇인지 이해하고 있다
  4. 나는 우리 회사의 비전이 무엇인지 이해하고 있다.
  5. 나는 우리 회사의 경영전략이 무엇인지 이해하고 있다.
  (모두 동일한 측정 개념: 비전/전략 인지도)

클러스터 40 (43개) - "부서간 협조"
  1. 회사 내 서로 다른 부서 및 팀간 원활한 의사소통 및 협조가 잘 이루어지고 있다
  2. 회사 내 다른 부서 및 팀간 원활한 의사소통 및 업무 협조가 잘 이루어지고 있다.
  3. 우리 회사는 부서간 업무 협조가 원활하게 이루어지고 있다.
  (모두 동일한 측정 개념: 부서간 협조)

클러스터 184 (9개) - "업무량 적정성"
  1. 나의 업무량은 적절한 수준이라고 생각한다
  2. 나의 업무량은 적절한 수준이라고 생각한다.
  3. 내게 주어진 업무량은 적정한 수준이다.
  (모두 동일한 측정 개념: 업무량 적정성)
```

#### 9.2.5 출력 파일
- `results/OD_문항_클러스터링_KoSBERT.xlsx`: 전체 문항별 클러스터 할당
- `results/OD_클러스터_요약_KoSBERT.xlsx`: 클러스터별 대표 문항 및 크기

#### 9.2.6 핵심 개선점

| 항목 | TF-IDF 방식 | KoSBERT 방식 | 개선 |
|------|-------------|--------------|------|
| "비전 이해" vs "비전 적절성" | 같은 클러스터 | 다른 클러스터 | ✅ |
| "리더→구성원 신뢰" vs "구성원→리더 신뢰" | 같은 클러스터 | 다른 클러스터 | ✅ |
| 일반 키워드("방식", "존재") 문제 | 오분류 발생 | 문맥 고려하여 분리 | ✅ |
| 표현만 다른 동일 문항 | 일부 분리됨 | 잘 묶임 | ✅ |

---

## 10. Hybrid Embedding 기반 분석 (분류체계 활용)

### 10.1 접근 방법

기존 분류체계(중분류/소분류)의 키워드를 문항에 추가하여 임베딩 품질 향상

```
문항: "우리 회사의 비전이 무엇인지 이해하고 있다"
     ↓ 분류 태그 추가
Hybrid 텍스트: "우리 회사의 비전이 무엇인지 이해하고 있다 [경영전략] [비전/전략]"
     ↓ KoSBERT 임베딩
768차원 벡터 (문장 의미 + 분류 정보 반영)
```

### 10.2 분류 키워드 사전

| 중분류 | 소분류1 | 매칭 키워드 |
|--------|---------|-------------|
| 경영전략 | 비전/전략 | 비전, 전략, 미션, 방향, 목표, 경영 |
| 조직문화 | 핵심가치 | 핵심가치, 가치, 원칙 |
| 조직/프로세스 | 조직구조 | R&R, 역할, 책임, 부서, 팀 |
| 조직/프로세스 | 의사소통 | 의사소통, 소통, 협조, 협력, 협업 |
| 리더십 | 리더행동 | 리더, 상사, 팀장, 부서장 |
| 인사제도 | 보상제도 | 보상, 급여, 연봉, 복리후생 |
| 인사제도 | 평가제도 | 평가, 성과관리, KPI |
| 조직몰입도 | 조직몰입도 | 몰입, 만족, 자부심, 추천 |

**분류 태그 적용률**: 79% (4,093/5,179개)

### 10.3 결과 비교

| 항목 | TF-IDF (500) | KoSBERT | Hybrid |
|------|-------------|---------|--------|
| 총 클러스터 수 | 500 | 1,967 | 2,198 |
| 평균 클러스터 크기 | 10.35 | 2.63 | 2.36 |
| 최대 클러스터 크기 | 63 | 70 | 61 |
| 싱글톤 클러스터 | 3 | 994 | 1,206 |
| 2개 이상 클러스터 | 497 | 973 | 992 |
| 5개 이상 클러스터 | 422 | 228 | 207 |

### 10.4 Hybrid 클러스터 샘플

**클러스터 74 (79개)** - 의사소통/협조
```
분류 태그: [조직/프로세스] [의사소통] 62개, [조직/프로세스] [조직구조] 17개
문항:
  1. 회사 내 서로 다른 부서 및 팀간 원활한 의사소통 및 협조가 잘 이루어지고 있다
  2. 회사 내 계층 간 의사소통이 원활하게 이루어지고 있다
  3. 우리 회사는 부서간 업무 협조가 원활하게 이루어지고 있다
→ 동일 분류(의사소통)의 문항들이 정확하게 그룹화됨
```

**클러스터 44 (67개)** - 비전/전략
```
분류 태그: [경영전략] [비전/전략] 67개 (100% 동일 분류)
문항:
  1. 우리 회사의 비전과 전략이 무엇인지 이해하고 있다
  2. 우리 회사의 비전은 명확하게 제시되어 있다
  3. 우리 회사는 높은 수준의 목표설정, 신사업 추진 등 비전을 제시하는 편이다
→ 비전 관련 문항들이 완벽하게 그룹화됨
```

### 10.5 출력 파일
- `results/OD_문항_클러스터링_Hybrid.xlsx`: 전체 문항별 클러스터 할당 (분류 태그 포함)
- `results/OD_클러스터_요약_Hybrid.xlsx`: 클러스터별 대표 문항 및 분류 정보
- `results/OD_분류체계_검증용.xlsx`: 분류체계별 문항 검증용 (아래 참조)

### 10.6 검증용 엑셀 구조

**파일**: `results/OD_분류체계_검증용.xlsx`

**시트 1: 분류체계_요약**
| 중분류 | 소분류 | 문항수 | 클러스터수 | 평균크기 |
|--------|--------|--------|------------|----------|
| 경영전략 | 비전/전략 | 773 | 326 | 2.4 |
| 인사제도 | 보상제도 | 236 | 53 | 4.5 |
| 조직/프로세스 | 조직구조 | 813 | 395 | 2.1 |
| ... | ... | ... | ... | ... |

**시트 2: 분류체계별_문항_검증**
| 중분류 | 소분류 | 클러스터ID | 클러스터크기 | 대표문항 | 개별문항 |
|--------|--------|------------|--------------|----------|----------|
| 경영전략 | 비전/전략 | 44 | 67 | 우리 회사의 비전과... | (실제 문항) |

**검증 방법**:
1. 분류체계_요약에서 검증할 분류 선택
2. 분류체계별_문항_검증에서 해당 분류 확인
3. 동일 클러스터ID의 문항들이 실제 동일 의미인지 검토
4. 대표문항과 개별문항 비교하여 그룹화 품질 확인

### 10.7 방식별 장단점

| 방식 | 장점 | 단점 | 권장 용도 |
|------|------|------|-----------|
| **TF-IDF** | 빠름, 간단 | 의미 구분 어려움 | 초벌 분류, 탐색 |
| **KoSBERT** | 의미 기반 정확한 구분 | 싱글톤 많음 | 정밀 분석 |
| **Hybrid** | 분류체계 반영, 동일 분류 그룹화 | 분류 태그 의존 | Master DB 구축 |

---

## 11. 전체 대분류 클러스터링 (OD/LD/MA/DD)

### 11.1 최종 분류 현황

| 대분류 | 문항수 | 분류율 | 클러스터수 | 설명 |
|-------|-------|-------|----------|------|
| OD | 5,179 | **100%** | 2,199 | 조직진단 |
| LD | 1,590 | **100%** | 697 | 리더십진단 |
| MA | 364 | **100%** | 275 | 다면평가 |
| DD | 210 | **100%** | 103 | 사외이사평가 |
| **전체** | **7,343** | **100%** | **3,274** | |

### 11.2 중분류 분포 (최종)

| 중분류 | 문항수 | 비율 |
|--------|--------|------|
| 조직/프로세스 | 2,456 | 33.4% |
| 리더십 | 2,421 | 33.0% |
| 인사제도 | 898 | 12.2% |
| 경영/전략 | 530 | 7.2% |
| 조직문화 | 420 | 5.7% |
| 기타 | 378 | 5.1% |
| 몰입도 | 240 | 3.3% |

### 11.3 분류 방법론 (3단계)

```
Stage 1: KoSBERT Hybrid Embedding
  └─ 문항 + 분류체계 태그 → 768차원 벡터
  └─ Agglomerative Clustering (threshold=0.15)
  └─ 결과: 3,274개 클러스터

Stage 2: 클러스터 기반 분류 상속
  └─ 같은 클러스터 내 분류된 문항의 분류를 미분류 문항에 상속
  └─ 결과: 89.6% 분류 완료

Stage 3: Claude API (LLM) 분류
  └─ 남은 765개 미분류 문항을 LLM으로 분류
  └─ 모델: claude-sonnet-4-20250514
  └─ 결과: 100% 분류 완료
```

### 11.4 출력 파일

| 파일명 | 설명 |
|--------|------|
| `results/전체_문항_클러스터링_Hybrid.xlsx` | 7,343개 문항 클러스터링 결과 |
| `results/전체_분류체계_검증용.xlsx` | 검증용 엑셀 (4개 시트) |
| `all_df_hybrid.pkl` | 전체 데이터 DataFrame |
| `all_embeddings_hybrid.npy` | 전체 문항 임베딩 (7343 x 768) |

---

## 12. 다음 단계

### 12.1 완료 항목
- [x] OD/LD/MA/DD 전체 문항 Hybrid 클러스터링
- [x] 클러스터 기반 분류 상속
- [x] LLM 기반 미분류 문항 분류 (100% 완료)
- [x] 대분류/중분류/소분류 체계 매핑
- [x] **클러스터별 대표 문항(Question Key) 선정** (Centroid 기반)

### 12.2 진행 예정
- [ ] Master DB 구조 설계 및 구축
- [ ] 유사 문항 검색 기능 개발

---

## 13. 대표 문항 (Question Key) 선정

### 13.1 선정 방식
- **Centroid 기반**: 각 클러스터의 중심점(평균 임베딩 벡터)에 가장 가까운 문항을 대표로 선정
- 싱글톤 클러스터(1개 문항)는 자동으로 본인이 대표

### 13.2 Question Key 형식
```
{대분류}_{클러스터번호(4자리)}
예: OD_0001, OD_0002, ... OD_2199
    LD_0001, ... LD_0697
    MA_0001, ... MA_0275
    DD_0001, ... DD_0103
```

### 13.3 결과

| 대분류 | 대표 문항 수 |
|-------|-----------|
| OD | 2,199 |
| LD | 697 |
| MA | 275 |
| DD | 103 |
| **전체** | **3,274** |

### 13.4 출력 파일

| 파일명 | 설명 |
|--------|------|
| `results/Master_Questions.xlsx` | 3,274개 대표 문항 목록 |
| `results/전체_문항_클러스터링_Hybrid.xlsx` | question_key, is_representative 컬럼 추가 |

---

## 14. 변경 이력

| 날짜 | 버전 | 변경 내용 | 작성자 |
|------|------|-----------|--------|
| 2024-12-22 | 1.0 | 초기 문서 작성, 데이터 구조 분석 | - |
| 2024-12-22 | 1.1 | 고객사 목록 추출, 금칙어 목록 추가 | - |
| 2024-12-22 | 1.2 | OD 문항 TF-IDF 클러스터링 결과 (500개 클러스터) | - |
| 2024-12-22 | 1.3 | TF-IDF 방식 한계점 분석 및 개선 방향 문서화 | - |
| 2024-12-22 | 1.4 | KoSBERT Sentence Embedding 클러스터링 실행 및 결과 비교 | - |
| 2024-12-22 | 1.5 | Hybrid Embedding (문항+분류체계) 클러스터링 구현 | - |
| 2024-12-22 | 1.6 | 분류체계별 검증용 엑셀 생성 (OD_분류체계_검증용.xlsx) | - |
| 2024-12-24 | 2.0 | **전체 대분류(OD/LD/MA/DD) 클러스터링 완료** | - |
| 2024-12-24 | 2.1 | 새 분류체계(251224) 통합, 클러스터 기반 분류 상속 | - |
| 2024-12-24 | 2.2 | **Claude API LLM 분류로 100% 분류 완료** | - |
| 2024-12-24 | 2.3 | **대표 문항(Question Key) 선정 완료** (Centroid 기반) | - |

---

*Last Updated: 2024-12-24*
